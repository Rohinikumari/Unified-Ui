<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="">  
    <title>Solution and Node Testing DCG</title>
    <!-- CSS for jquery table -->
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Fileupload CSS
    <link href="css/fileinput.min.css" rel="stylesheet">-->
    <!-- Custom styles for this template -->
    <link href="css/signup.css" rel="stylesheet">
    <link href="css/landing.css" rel="stylesheet">
    <link href="css/datatables.css" rel="stylesheet">
    <link href="css/cgw.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <!--<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"> -->
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
     <!--<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css"> -->
  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]>
  <!-->
   <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css"> 
   <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
  <!--[if lte IE 8]>
  <link rel="stylesheet" href="css/layouts/marketing-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]>
  <!-->
   <link rel="stylesheet" href="css/marketing.css">
   <link rel="stylesheet" href="css/emqtt.css">
   <!--<![endif]-->
  <!-- <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script> -->
 <style type="text/css">
.form-style-4{
	max-width: 450px;
	margin:10px auto;
	font-size: 16px;
	background: #495C70;
	padding: 30px 30px 15px 30px;
	border: 5px solid #53687E;
}
.form-style-4 input[type=submit],
.form-style-4 input[type=button],
.form-style-4 input[type=text],
.form-style-4 input[type=email],
.form-style-4 textarea,
.form-style-4 label
{
	font-family: Georgia, "Times New Roman", Times, serif;
	font-size: 16px;
	color: #fff;

}
.form-style-4 label {
	display:block;
	margin-bottom: 10px;
}
.form-style-4 label > span{
	display: inline-block;
	float: left;
	width: 150px;
}
.form-style-4 input[type=text],
.form-style-4 input[type=date],
.form-style-4 input[type=datetime],
.form-style-4 input[type=number],
.form-style-4 input[type=search],
.form-style-4 input[type=time],
.form-style-4 input[type=url],
.form-style-4 input[type=email] 
{
	background: transparent;
	border: none;
	border-bottom: 1px dashed #83A4C5;
	width: 275px;
	outline: none;
	padding: 0px 0px 0px 0px;
	
}
.form-style-4 textarea{
	
	padding: 0px 0px 0px 0px;
	background: transparent;
	outline: none;
	border: none;
	border-bottom: 1px dashed #83A4C5;
	width: 275px;
	overflow: hidden;
	resize:none;
	height:20px;
}

.form-style-4 textarea:focus, 
.form-style-4 input[type=text]:focus,
.form-style-4 input[type=date]:focus,
.form-style-4 input[type=datetime]:focus,
.form-style-4 input[type=number]:focus,
.form-style-4 input[type=search]:focus,
.form-style-4 input[type=time]:focus,
.form-style-4 input[type=url]:focus,
.form-style-4 input[type=email]:focus
{
	border-bottom: 1px dashed #D9FFA9;
}

.form-style-4 input[type=submit],
.form-style-4 input[type=button]{
	background: #576E86;
	border: none;
	padding: 8px 10px 8px 10px;
	border-radius: 5px;
	color: #A8BACE;
}
a{
color: #F08D0E;
}
 </style>
<script type="text/javascript">
function adjust_textarea(h) {
    h.style.height = "20px";
    h.style.height = (h.scrollHeight)+"px";
}
</script>
</head>
<style>
#demo {
    text-align: right;
    color: white;
}
</style>
<body class="landing-body">
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
 <p class="logo"><a href="http://13.250.24.178:3500/login.html"><button onclick="removeData();"><img align = "left" alt="" src = "/img/logout.png" height = "15" width = "15"></button>
</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unified UI</p><p id="demo"></p>
        </div>
        <div class="navbar-collapse navbar-ex1-collapse collapse" style="height: 1px;">
           <ul class="nav nav-sidebar navbar-inverse side-nav">
	    <div class="scroll">	        
              
	     <div class="dropdown">
		<button onclick="myFunction()" class="dropbtn">STANDARD DEVICE CLOUD GATEWAY</button>
		<div id="myDropdown" class="dropdown-content">
		<a href="CloudProvisioning.html">Cloud Provisioning</a>
		<a href="solutionProvisioning.html">Solution Provisioning</a>
		<a href="DeviceProvisioningOrInventory.html">Device Provisioning/Inventory</a>
		<a href="localtestdemo.html">Local Operation (EMQTT)</a>
		<a href="remoteoperationdemo.html">Remote Operation (DCG)</a>
                <a href="registrationGateway.html">Registration via API Gateway</a>
		<a href="registration.html">Direct Standard Gateway Registration</a>
		<br>		
		<div class="dropdown2">		
		<button onclick="myFunction2()" class="dropbtn2">PONTE APPS</button>
                <div id="myDropdown2" class="dropdown2-content">
		<a href="PartnerTesting.html">Admin Testing with Ponte</a>
		<a href="operatorTesting.html">Operator Testing with Ponte</a>
		<a href="solutionTesting.html">Solution Testing with Ponte</a>
		<a href="Solution&NodeTesting.html">Solution and Node Testing with Ponte</a>
		<a href="NodeTesting.html">Nodes Testing with Ponte</a>
		</div>
		</div>
                <div class="dropdown11">
		<button onclick="location.href=''" class="dropbtn11">TCP/IP ADAPTER APPS</button>
                <div id="myDropdown11" class="dropdown11-content">
		</div>
		</div>		
		</div> 
		</div>
		<br>
		<br>
		<div class="dropdown22">
		<button onclick="myFunction22()" class="dropbtn22">SOL DEVELOPMENT(AUTH CODE)</button>
                <div id="myDropdown22" class="dropdown22-content">
		<a href="webAppAccessWithoutSecretKey.html">MOBILE WEB APP ACCESS WITHOUT SECRET KEY</a>
		<a href="webAppAccessWithSecretKey.html">MOBILE WEB APP ACCESS WITH SECRET KEY</a>
		<a href="mobilewebappCreationandAccessGrant.html">MOBILE WEB APP CREATION AND TESTING (AUTH GRANT FLOW)</a>
		<div class="dropdown24">
		<button onclick="myFunction24()" class="dropbtn24">MOBILE NATIVE APP</button>
                <div id="myDropdown24" class="dropdown24-content">
		<a href="">Get Authorization Code</a>	
		<a href="">Get Access Token</a>	
		<a href="">Call Other Api's For Mobile App Development</a>	
		</div>
		</div>
		<div class="dropdown19">
		<button onclick="myFunction19()" class="dropbtn19">MOBILE HYBRID APP</button>
                <div id="myDropdown19" class="dropdown19-content">
		<a href="deviceRegister.html">Device Registration</a>
		<a href="appRegister.html">App Registration</a>
		<a href="appSolActivation.html">App/Solution Activation</a>
		<a href="getAuthorizationCode.html">Get Authorization Code</a>	
		<a href="getAccessToken.html">Get Access Token</a>	
		<a href="mobilewebsite.html">Create Mobile Website</a>
		<a href="accessCreatedMobileWebsite.html">Access Created Mobile Website</a>
		</div>
		</div>
		</div>
		</div>
		<br>
		<br>
		<div class="dropdown26">
		<button onclick="myFunction26()" class="dropbtn26">SOL DEVELOPMENT(IMPLICIT)</button>
                <div id="myDropdown26" class="dropdown26-content">
		<a href="mobilewebappImplicit.html">MOBILE WEB APP CREATION AND TESTING (IMPLICIT)</a>	
		</div>
		</div>
		<br>
		<br>
		<div class="dropdown20">
		<button onclick="myFunction20()" class="dropbtn20">MY RESOURCES</button>
                <div id="myDropdown20" class="dropdown20-content">
		<a href="mySolutions.html">My Solutions</a>	
		<a href="mysites.html">My Sites</a>	
		<a href="mydevices.html">My Devices</a>	
		</div>
		</div>
		<br>
		<br>		
		<div class="dropdown9">
		<button onclick="myFunction9()" class="dropbtn9">ONE M2M SERVICE</button>
                <div id="myDropdown9" class="dropdown9-content">
		<div class="dropdown6">
		<button onclick="myFunction6()" class="dropbtn6">DCG APPS</button>
                <div id="myDropdown6" class="dropdown6-content">
		<a href="partnerTestingDCG.html">Admin Testing with DCG</a>
                <a href="operatorTestingDCG.html">Operator Testing with DCG</a>
		<a href="solutionTestingDCG.html">Solution Testing with DCG</a>
		<a href="solution&nodesTestingDCG.html">Solution and Nodes Testing with DCG</a>
		<a href="nodesTestingDCG.html">Node Testing with DCG</a>
		</div>
		</div>
		<div class="dropdown10">
		<button onclick="myFunction10()" class="dropbtn10">OTA</button>
                <div id="myDropdown10" class="dropdown10-content">
		<a href="">Firmware pending update</a>
		<a href="">Software pending update</a>
               	</div>
		</div>
		<div class="dropdown8">
		<button onclick="myFunction8()" class="dropbtn8">SDP</button>
                <div id="myDropdown8" class="dropdown8-content">
		</div>
		</div>
		</div>
		<br>
		<br>		
		<div class="dropdown16">
		<button onclick="myFunction16()" class="dropbtn16">SITE INSTALLER</button>
                <div id="myDropdown16" class="dropdown16-content">
		<a href="spot.html">Spot</a>
		<a href="lot.html">Lot</a>
                <a href="remoteaccessvalidation.html">Remote Access Validation</a>		
		</div>
		</div>
		<br>
		<br>
	        <div class="dropdown3">
		<button onclick="myFunction3()" class="dropbtn3">APP</button>
                <div id="myDropdown3" class="dropdown3-content">
		<a href="app.html">All Categories & Content</a>
		</div>
		</div>
		<br>
		<br>
		</div>
	    </ul>
        </div>
    </div>
</div>
<script src="js/cgw.js"></script>
<script>
 function removeData(){
	
	console.log("inside remove data");
	localStorage.removeItem('realm');	
	localStorage.removeItem('accessToken');
	localStorage.removeItem('userId');
     }
        var usrid = localStorage.getItem('userId');
	console.log("userId.... " +usrid);
	document.getElementById("demo").innerHTML = usrid;
</script>
<div class="container-fluid" id="wrapper" data-platform=''>   
</div>
<div id="output"></div>
       <center>      						
			<div id="page">
			<div id="content">
			<div class="border"></div>
			<div class="main" id="form-elem-section" style="width: 100%">
			<p class="p" align="center">
			<form name="f1" id="f1" class="form-style-4" action="" method="post">
			<font size = "5" color="white">SOLUTION AND NODES TESTING WITH DCG</font>					
			</p><br><br><br>
			<input type="hidden" value="11" name="src">	
			<label for="field1">
			<span>Partner Id</span><input type="text" name="partnerid" id="partnerid" required="true" />
			</label>      
			<label>
			<span>&nbsp;</span><input type="submit" onclick="getSolutionList()" value="Submit" />
			</label>
                       <table border="1" color=" #576E86" width="100%" cellpadding="10">								
			<label for="field1">
			<span>Solution List</span>
                        <tr>
			<td  id ="msg"></td>
			</tr>
			</label>				
			</table>
			<table border="1" color=" #576E86" width="100%" cellpadding="10">								
			<label for="field1">
			<span>Device List</span>
                        <tr>
			<td id ="dlist"></td>
			</tr>
			</label>				
			</table>			
			<table border="1" color=" #576E86" width="100%" cellpadding="10">								
			<label for="field1">
			<span>Connection Status</span>
                        <tr>
			<td id ="cs"></td>
			</tr>
			</label>				
			</table>
			<table border="1" color=" #576E86" width="100%" cellpadding="10">								
			<label for="field1">
			<span>Payload Status</span>
                        <tr>
			<td id ="pl"></td>
			</tr>
			</label>				
			</table>
			<table border="1" color=" #576E86" width="100%" cellpadding="10">								
			<label for="field1">
			<span>Battery Status</span>
                        <tr>
			<td id ="bs"></td>
			</tr>
			</label>				
			</table>
			</form>     
    </div>
    <div class="ribbon l-box-lrg pure-g">

      <div class="l-box-lrg pure-u-2-3">
        <button class="pure-button btn-clear">message clear</button>
        <div class="messages"></div>
      </div>

      <div class="pure-u-1-3">

        <form class="pure-form">
          <fieldset>
            <legend>Connect / Disconnect</legend>
            <button class="pure-button btn-connect">connect</button>
            <button class="pure-button btn-disconnect">disconnect</button>
          </fieldset>
		  
          <fieldset>
            <legend></legend>
            <label>
			  Address:
              <input type="text" class="input-broker-ws" value="http://52.89.109.174:3000"></label>
          </fieldset>

          <fieldset>
            <legend>Subscribe / Unsubscribe</legend>
            <label>
              Topic:
              <input type="text" class="input-topic-sub" value="PARTNER/#/#"></label>
            <button class="pure-button btn-subscribe">subscribe</button>
            <button class="pure-button btn-unsubscribe">unsubscribe</button>
          </fieldset>

          <fieldset>
            <legend>Publish</legend>
            <label>
              Topic:
              <input type="text" class="input-topic-pub" value="PARTNER/#/SOLUTION/#/NODE/#/ST"></label>
            <label>
              Message:
              <input type="text" class="input-message" value="nId=12=nT=SOLUTION&NODE=status=1"></label>
            <button class="pure-button btn-publish">publish</button>
          </fieldset>
        </form>
      </div>
    </div> 
  <div class="footer">
        <div class="">
        <p class=""> &copy; 2016 U-NaaS. All rights reserved</p>
        </div> </div>
   <script src="js/mows.js"></script>
  <script src="js/main.js"></script>  
    </center>
<script>

	var onImg       = "greenLight.jpg";
	var offImg      = "redLight.jpg";
        var onfanImg    = "onfan.gif";
	var offfanImg   = "offfan.jpg";
        var ondrapesImg = "ondrapes.jpg";
	var offdrapesImg = "offdrapes.png";
        var occupied    = "car.png";
	var unoccupied  = "nocar.jpg";
        var connected   = "connected.png";
	var unconnected = "unconnected.png";
        var notFound    = "notfound.jpg";
	var imgUrl      = "/img/";
	var amiLoaded   = false;
      
	var baseSolList ="http://54.254.214.241:8080/OP-BackEnd-Gateway/opgateway/";
	var consumerURL = "http://54.254.214.241:8080/ConsumerBackEndGateway/Consumer/";
	var realm = localStorage.getItem('realm');         // getting realm from web storage (local storage)
	var token = localStorage.getItem('accessToken');  // getting access token from web storage (local storage)
	
	var light = 0, fan = 0, drapes = 0, parking = 0;
	
        function onExit() {
		amiLoaded = false;
		console.log("onExit called...");		
	}

	window.onunload = onExit;

	function getImageUrl(boolOnOff) {
		if (boolOnOff==true) {
			return imgUrl + onImg;
		} else {
			return imgUrl + offImg;
		}
	}

       function getfanImageUrl(boolOnOff) {
		if (boolOnOff==true) {
			return imgUrl + onfanImg;
		} else {
			return imgUrl + offfanImg;
		}
	}

     function getdrapesImageUrl(boolOnOff) {
		if (boolOnOff==true) {
			return imgUrl + ondrapesImg;
		} else {
			return imgUrl + offdrapesImg;
		}
	}
        function getpaImageUrl(boolOnOff) {
		if (boolOnOff==true) {
			return imgUrl + occupied;
		} else{
			return imgUrl + unoccupied;
		}
	}

       function getConnImageUrl(boolOnOff) {
		if (boolOnOff==true) {
			return imgUrl + connected;
		}else if (boolOnOff==false) {
			return imgUrl + unconnected;		
                }else {
                        return imgUrl + notFound;	
                  }
	}


	var lightStatus = null;

	function doAction(img_name) {
		var swState = '1';

		if (document[img_name].src.search(offImg) == -1) {
			//OFF
			swState = '0';
			$('#slider01').val(0);
			$('#slider01').slider('refresh');
		}
		document['light'].src = getImageUrl(false);
	}	
				/* For LIGHT */

	// get Status

        var lampStatus = null;
	function getdevicestatusLight(ipaddr,sid,ulight) {
		var ipaddr;
		var sid;
		var ulight;

		console.log("Light Udn ====>"+ulight);
	$.ajax({
			type : "GET",
			url : ipaddr+sid+"/"+ulight+"/getStatus",
			contentType : "text/xml; charset=utf-8",
			crossDomain : true,
			processData : false,
			data : "",
		}).done(function(xml) {
			console.log(xml);
			var lightStatus = $(xml).find('status').text();
                        var lightconnStatus = $(xml).find('connectionStatus').text();
			console.log("lightStatus : " + lightStatus);
                        console.log("lightconnStatus : " + lightconnStatus);

			if (lightStatus == "0"&&lightconnStatus== "connected") {
				document['light'].src = getImageUrl(false);
                                lampStatus = 0;
				console.log("Turned OFF");
			}
                        else if (lightStatus == "1"&&lightconnStatus== "connected"){
                                document['light'].src = getImageUrl(true);
                                lampStatus = 1;
				console.log("Turned ON");

                        } else if (lightStatus == "null"&&lightconnStatus== "unconnected"){
                                document['light'].src = getConnImageUrl(false);
                                lampStatus = null;
				console.log("DEVICE UNCONNECTED (LIGHT)");

                        } else if (lightStatus == "null"&&lightconnStatus== "connected"){
                                document['light'].src = getConnImageUrl(true);
                                lampStatus = null;
				console.log("DEVICE CONNECTED (LIGHT)");
                        }
                       else {
                                document['light'].src = getConnImageUrl('notfound');
				console.log("DEVICE NOT FOUND (LIGHT)");
			}			
		}).error(function() {
     		console.log("Status Error Occured");
		}).complete(function() {
			console.log("Completed");
		});
	}
					/* For FAN */

	// get Status	

       var fanStatus = null;    
       function getdevicestatusFan(ipaddr,sid,ufan) { 
		var ipaddr;
		var sid;
		var ufan;
		console.log("Fan Udn ====>"+ufan);		
        $.ajax({
	      	  type: "GET",
	      	  url: ipaddr+sid+"/"+ufan+"/getStatus",     	  
	      	  contentType: "text/xml; charset=utf-8",
	      	  crossDomain: true,
	      	  processData: false,
	      	  data: "",
      	}).done(function( xml ) {
                console.log(xml);   
		var Status = $(xml).find('status').text();  	
		var connectionStatus = $(xml).find('connectionStatus').text();  		
		console.log("fanStatus : "+Status);
                console.log("connectionStatus : "+connectionStatus);
		if(!Status)
		{
			console.log( "Malformed XML Status Response Received:" + Status );
		}
		else
		{			
				if(Status == "0"&&connectionStatus=="connected")
				{
					document['fan'].src=getfanImageUrl(false);
                                        fanStatus = 0;
					console.log("Turned OFF");

				}else if(Status == "1"&&connectionStatus=="connected"){
                                        document['fan'].src=getfanImageUrl(true);
                                        fanStatus = 1;
					console.log("Turned ON");

                                }else if (Status == "null"&&connectionStatus== "unconnected"){
		                        document['fan'].src = getConnImageUrl(false);
		                        fanStatus = null;
					console.log("DEVICE UNCONNECTED (FAN)");

                                }else if (Status == "null"&&connectionStatus== "connected"){
		                        document['fan'].src = getConnImageUrl(true);
		                        fanStatus = null;
					console.log("DEVICE CONNECTED (FAN)");
                                }else
				{       document['fan'].src = getConnImageUrl('notfound');
					console.log("DEVICE NOT FOUND (FAN)");
				}				
			}
		}).error(function() {
			console.log("Status Error Occured");
		}).complete(function() {
			console.log("Completed");
		});
        }
				/* For DRAPES */

        // get Status

        var drapesStatus = null; 
        function getdevicestatusDrapes(ipaddr,sid,udrapes) { 
		   var ipaddr;
		   var sid;
		   var udrapes;	
		   console.log("DRAPES Udn ====>"+udrapes);		   
           $.ajax({
         	  type: "GET",      	  
   		  url: ipaddr+sid+"/"+udrapes+"/getStatus",    	  
         	  contentType: "text/xml; charset=utf-8",
         	  crossDomain: true,
         	  processData: false,
         	  data: "",
         	}).done(function( xml ) {
         console.log(xml); 
         var Status = $(xml).find('status').text();       
         var connStatus = $(xml).find('connectionStatus').text();      
   		console.log("DrapesStatus : "+Status);
                console.log("connStatus : "+connStatus);
   		if(!Status)
   		{
   			console.log( "Malformed XML Status Response Received:" + Status);
   		}
   		else
		{			
				if(Status == "0"&&connStatus=="connected"){

					document['drapes'].src=getdrapesImageUrl(true);
                                        drapesStatus = 0;
					console.log("Turned OFF");

				}else if(Status == "1"&&connStatus=="connected"){

					document['drapes'].src=getdrapesImageUrl(false);
                                        drapesStatus = 1;
					console.log("Turned ON");

				}else if (Status == "null"&&connStatus== "unconnected"){
		                        document['drapes'].src = getConnImageUrl(false);
		                        drapesStatus = null;
					console.log("DEVICE UNCONNECTED (DRAPES)");

                                }else if (Status == "null"&&connStatus== "connected"){
		                        document['drapes'].src = getConnImageUrl(true);
		                        drapesStatus = null;
					console.log("DEVICE CONNECTED (DRAPES)");
                                }
				else
				{       document['drapes'].src = getConnImageUrl('notfound');
					console.log("DEVICE NOT FOUND (DRAPES)");
				}				
							
                                }
		}).error(function() {
			console.log("Status Error Occured");
		}).complete(function() {
			console.log("Completed");
		});
    }


                                                    /* For PARKING */


	// get Status

        var parkingStatus = null;
	function getparkingstatus(ipaddr,sid,uparking) {
		var ipaddr;
		var sid;
		var uparking;
		console.log("Parking Udn ====>"+uparking);
	$.ajax({
			type : "GET",
			url : ipaddr+sid+"/"+uparking+"/getStatus",
			contentType : "text/xml; charset=utf-8",
			crossDomain : true,
			processData : false,
			data : "",
		}).done(function(xml) {
			console.log(xml);
			var pStatus = $(xml).find('status').text();
                        var connectionStatus = $(xml).find('connectionStatus').text();
			console.log("parkingStatus : " + pStatus);
                        console.log("connectionStatus : " + connectionStatus);
			
                        if (pStatus == "00"&&connectionStatus=="connected") {
				document['parking'].src = getpaImageUrl(false);
                                parkingStatus = 00;
				console.log("UNOCCUPIED SPACE");

			}else if (pStatus == "01"&&connectionStatus=="connected"){
                                document['parking'].src = getpaImageUrl(true);
                                parkingStatus = 01;
				console.log("UNOCCUPIED SPACE");

                        }else if (pStatus == "null"&&connectionStatus== "unconnected"){
		                document['parking'].src = getConnImageUrl(false);
		                parkingStatus = null;
				console.log("DEVICE UNCONNECTED");

                        }else if (pStatus == "null"&&connectionStatus== "connected"){
		                document['parking'].src = getConnImageUrl(true);
		                parkingStatus = null;
				console.log("DEVICE CONNECTED");

                        }else {
                                document['parking'].src = getConnImageUrl('notfound');
				console.log("DEVICE NOT FOUND (PARKING-SENSOR)");
			}			
		}).error(function() {
     		console.log("Status Error Occured");
		}).complete(function() {
			console.log("Completed");
		});
	}	


        // get solution list
	function getSolutionList() {
	
						var paid=document.f1.partnerid.value;
						document.getElementById('partnerid').innerHTML=paid;				
	        $.ajax({		
						type : "GET",					
						url : consumerURL+realm+"/"+paid+"/registerStatus",
						contentType : "text/xml; charset=utf-8",
						crossDomain : true,
						processData : false,
						headers: {
						  'Authorization': 'Bearer '+token
						},
						})
						.done(
						function(xml) {
						var solutionId="";						
						var valueSol = "<table>";			
						$(xml).find("solution").each(function() {
						$(this).find("id").each(function(){
						solutionId =  $(this).text();
						});						
					        $(this).find("status").each(function(){
						solutionSt =  $(this).text();	
						if(solutionSt!=null){
						console.log("Solution Register Status ====> : " + solutionSt);
						valueSol += "<tr>"						
						+"<td align='left'><a href='#' onclick=getMasterIndex('"+solutionId+"');>"+solutionSt+"</a></td>"; 
						+"</tr>";
						}
						else{
						document.write("No Solution Id Found ");
						}
						
						});
				                });
						valueSol +="</table>";						
						console.log("valueSol value ====> : " + valueSol);
						document.getElementById("msg").innerHTML = valueSol;
						}).error(function() {
						console.log("Status Error Occured");
						}).complete(function() {
						});
				}
		
        	
	//// get iot master index of solution
	function getMasterIndex(solutionId) {
				var solutionId;
				console.log("solution id.... " + solutionId);				
			$.ajax({		
						type : "GET",					
				                url : baseSolList+'solution/iotMasterIndex/'+realm+'/'+solutionId+"/sip:"+solutionId+"@unaas.com",					
						contentType : "text/xml; charset=utf-8",
						crossDomain : true,
						processData : false,
						headers: {
						  'Authorization': 'Bearer '+token
						},
						})
			.done(
						function(xml) {
						var registration="";	
						//var serviceaction="";
						$(xml).find("entry").each(function() {								
					        registration = $(this).find("cssoUrl").text();
					        //serviceaction = $(this).find("DeviceServiceActionUri").text();								
					        console.log("check resgistration api... " + registration);
						//console.log("get serviceaction... " + serviceaction);									
						 });	
						 checkRegistration(registration,solutionId);
						 }).error(function() {
						 console.log(" Error Occured");
						 }).complete(function() {
						 });
	}

	
	
	// check Registration
	function checkRegistration(registration,solutionId) {
						
						console.log("realm... "+realm);
	$.ajax({		
						type : "GET",				 					
						url : registration,
						contentType : "text/xml; charset=utf-8",
						crossDomain : true,
						processData : false,
						})
						.done(
						function(xml) {
						var dcgAddress="";										
						$(xml).find("controlUrl").each(function() {								
						dcgAddress = $(this).find("public").text();
						console.log("address of dcg... " + dcgAddress);
						dcgpath = dcgAddress+"/DCG/";
						getParentId(dcgpath,solutionId);
						});								
						}).error(function() {
						alert("solution not registered... " +solutionId);
						}).complete(function() {
						console.log("Completed");
						});
	}	
	
	
	// get parent id
        function getParentId(dcgpath,solutionId) {
						
						console.log("dcgpath & solutionid... " +dcgpath+solutionId);				
        $.ajax({		
						type : "GET",				 					
						url : baseSolList+"getParent/"+realm+"/"+solutionId,
						contentType : "text/xml; charset=utf-8",
						crossDomain : true,
						processData : false,
						headers: {
						  'Authorization': 'Bearer '+token
						},
						})
						.done(function(xml) {				
						var parentid = $(xml).find('parentId').text();
						console.log("parent id... "+parentid);
						getdevicelist(dcgpath,solutionId,parentid);                               					
						}).error(function() {
						console.log("parent id not found");
						}).complete(function() {
						console.log("Completed");
						});
	}	

	// get list of devices
	function getdevicelist(dcgpath,solutionId,parentid) {
					
					var dcgpath;
					var solutionId;
					var parentid;	
                                        console.log("inside get devices... ");	
				        			
		        $.ajax({
						type : "GET",
						url : baseSolList+"getDeviceList/"+realm+"/"+solutionId+"/sip:"+solutionId+"@unaas.com",
						contentType : "text/xml; charset=utf-8",
						crossDomain : true,
						processData : false,
						headers: {
						  'Authorization': 'Bearer '+token
						},
			}).done(
						function(xml) {
				     		var txt;
						var udn;
						var deviceType;
						var value = "<table>";
						$(xml).find("deviceid").each(function() {
						txt = $(this).attr("did");
						udn = $(this).attr("udnid");
						deviceType = $(this).attr("deviceType");
						console.log("device id.... " + txt);
						console.log("device udn.... " + udn);
						console.log("device type... " + deviceType);
						if(txt!=null){
						console.log("Device Id ====> : " + txt);
						value += "<tr>"						
						+"<td align='center'><a href='#' onclick=getConnectionStatus('"+solutionId+"','"+udn+"');>"+solutionId+"-"+udn+"</a></td>"; 
						+"</tr>";
						}else{
						document.write("device id not found ");
						}});
                                                value += "</table>";
						document.getElementById("dlist").innerHTML = value;				
						}).error(function() {
					        console.log("error in getting devices");
						}).complete(function() {			
						console.log("Completed");
						});
	}
	
	
		
	function getConnectionStatus(solutionId,udn){
	
			var solId = solutionId;
			var udnId = udn; ;
			console.log("Solution id ====> : " + solId);
			console.log("udn id ====> : " + udnId);
	    $.ajax({		
			type : "GET",					
			url : consumerURL+realm+"/"+solId+"/"+udnId+"/getStatus",
			contentType : "text/xml; charset=utf-8",
			dataType : "xml",
			crossDomain : true,
			processData : false,
			headers: {
				'Authorization': 'Bearer '+token
			},
			})
			.done(
			function(xml) {
			console.log("Consumer status... "+xml);
		     	var connStatus="";
			var valueConn = "<table>";			
			$(xml).find("deviceStatus").each(function() {
			$(this).find("connectionStatus").each(function(){			
			connStatus =  $(this).text();
			if(connStatus!=null){
			console.log("Connection Status ====> : " + connStatus);
			valueConn += "<tr>"						
			+"<td align='left' style='color:#F08D0E'>"+udnId+"-"+connStatus+"</a></td>";
			+"</tr>";
			}			
			else{
			document.write("Connection Status Not Found ");
			}			
			});});
			valueConn +="</table>";	
			
			var pL="";
			var valuePayload = "<table>";
			$(xml).find("deviceStatus").each(function() {
			$(this).find("payloadStatus").each(function(){
			pL =  $(this).text();
			if(pL!=null){
			console.log("Payload status ====> : " + pL);
			valuePayload += "<tr>"						
			+"<td align='left' style='color:#F08D0E'>"+udnId+"-"+pL+"</a></td>";
			+"</tr>";
			}			
			else{
			document.write("Payload status Not Found ");
			}			
			});});
			valuePayload +="</table>";
			
			var battery="";
			var valueBattery = "<table>";
			$(xml).find("deviceStatus").each(function() {
			$(this).find("batteryStatus").each(function(){
			battery =  $(this).text();
			if(battery!=null){
			console.log("Battery Status  ====> : " + battery);
			valueBattery += "<tr>"						
			+"<td align='left' style='color:#F08D0E'>"+udnId+"-"+battery+"</a></td>";
			+"</tr>";
			}			
			else{
			document.write("Battery Status Not Found ");
			}			
			});});			
			valueBattery +="</table>";			
			
			console.log("valueSol value ====> : " + valueConn);
			document.getElementById("cs").innerHTML = valueConn;
			
			console.log("value value ====> : " + valuePayload);
			document.getElementById("pl").innerHTML = valuePayload;
			
			console.log("valueBattery value ====> : " + valueBattery);
			document.getElementById("bs").innerHTML = valueBattery;
			
			}).error(function() {
			console.log("Status Error Occured");
			}).complete(function() {
			});
	}	
</script>
</body>
</html>